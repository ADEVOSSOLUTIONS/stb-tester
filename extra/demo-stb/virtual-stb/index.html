<!DOCTYPE html>
<html lang='en'>
<head>
  <meta charset='utf-8' />
  <title>stb-tester demo stb</title>

  <style>
    body, div, h1, p, ul, li {
      margin: 0; padding: 0;
    }
    body {
      background-color: #000;
      font-family: Verdana, sans-serif; font-size: 12pt;
      margin: 0; padding: 0; overflow: hidden;
    }
    #body {
      position: absolute; margin: 0; padding: 0;
      width: 1280px; height: 720px;
    }
    #tv {
      position: absolute; z-index: -1; width: 100%; height: 100%;
    }
    #logo {
      position: absolute; top: 20px; right: 0; z-index: 4;
      width: 225px;
      opacity: 0.6;
    }
    #pause-patch {
      display: none;
      position: absolute; top: 240px; left: 520px;
      width: 240px; height: 240px; text-align: center;
      font-size: 120px; line-height: 240px;
      background-color: rgba(200, 200, 200, 0.7);
      border-radius: 12px;
    }

    .help {
      position: absolute; bottom: 20px; right: 20px;
      list-style: none; margin: 0; padding: 0;
      text-align: center; color: #fff;
      z-index: 1;
    }
    .help li {
      list-style: none; margin-top: 10px;
    }
    .help li a {
      display: inline; width: 60px; text-decoration: none; padding-bottom: 10px;
    }
    .help h1 {
      width: 40px; height: 40px; line-height: 40px; margin: 0 auto;
      background-color: #fff; border-radius: 8px;
      box-shadow: 2px 2px 2px 0 #333;
      font-size: 18pt; color: #333;
    }
    .help p {
      color: #fff; text-shadow: 2px 2px 2px #333;
    }
    #close-button h1 {
      font-size: 9pt;
    }
    #search-button h1 {
      font-size: 24pt;
    }
    .help h1.return {
      line-height: 45px;
    }

    @font-face {
      font-family: LigatureSymbols;
      src: url('LigatureSymbols-2.11.ttf') format('truetype');
      font-weight: normal;
      font-style: normal;
    }
    .ligaturesymbols {
      font-family: LigatureSymbols;
    }

    #home {
      position: absolute; transition: 1s; left: -100%;
      width: 100%; height: 100%;
      background-color: rgba(200, 200, 200, 0.7);
    }
    #home.active {
      left: 0;
    }
    #home .carousel {
      position: absolute; top: 30px; left: 50px;
    }
    #home .carousel img {
      width: 170px; height: 240px;
    }
    #home .carousel img + p {
      width: 170px;
      font-size: 12pt;
      overflow: hidden; text-overflow: ellipsis; white-space: nowrap;
    }
    #home .carousel div {
      position: absolute; padding: 10px; text-align: center;
      color: #fff; font-weight: bold;
    }
    #home .carousel div:nth-child(1),
    #home .carousel div:nth-child(2),
    #home .carousel div:nth-child(3),
    #home .carousel div:nth-child(4) { top: 0; }
    #home .carousel div:nth-child(5),
    #home .carousel div:nth-child(6),
    #home .carousel div:nth-child(7),
    #home .carousel div:nth-child(8) { top: 302px; }
    #home .carousel div:nth-child(4n+1) { left: 0; }
    #home .carousel div:nth-child(4n+2) { left: 210px; }
    #home .carousel div:nth-child(4n+3) { left: 420px; }
    #home .carousel div:nth-child(4n+4) { left: 630px; }
    #home .carousel { z-index: 2; }
    #home .carousel-backgrounds { z-index: 0; }
    #home .carousel-backgrounds div { background-color: #000; }
    #home .carousel-selection {
      position: absolute; top: 0; left; 0; z-index: 1;
      background: linear-gradient(to bottom, #0085e3, #005a9c);
      transition-duration: 0.3s;
    }

    #dialogue {
      display: none;
      position: absolute; width: 100%; height: 100%; z-index: 3;
      background-color: rgba(200, 200, 200, 0.7);
      text-align: center;
    }
    #dialogue div {
      margin: 240px auto 0; width: 50%; padding: 40px;
      background-color: #fff; color: #333;
      border-radius: 8px; box-shadow: 2px 2px 2px 0 #333;
    }
    #dialogue h1 {
      font-size: 18pt; margin: 0 0 1em;
    }
  </style>
</head>

<body>
<div id="body">

<video id="tv" src="big_buck_bunny_480p_stereo.ogg" autoplay loop muted></video>

<img id="logo" src="stb-tester.svg">

<div id="pause-patch" class="ligaturesymbols"></div>

<ul id="tv-help" class="help">
  <li id="pause-button">
    <a href="#">
      <h1>P</h1>
      <p>Pause</p>
    </a>
  </li>
  <li id="home-button">
    <a href="#">
      <h1>H</h1>
      <p>Home</p>
    </a>
  </li>
</ul>

<div id="home">

  <div class="carousel">
    <div data-movie="ed_1024.ogv">
      <img src="thumbnail-ed.jpg">
      <p>Elephants Dream</p>
    </div>
    <div data-movie="big_buck_bunny_480p_stereo.ogg">
      <img src="thumbnail-bbb.jpg">
      <p>Big Buck Bunny</p>
    </div>
    <div data-movie="sintel_trailer-720p.ogv">
      <img src="thumbnail-sintel.jpg">
      <p>Sintel</p>
    </div>
    <div data-movie="tears_of_steel_720p.mkv">
      <img src="thumbnail-tos.png">
      <p>Tears Of Steel</p>
    </div>
    <div>
      <img src="thumbnail-hercules.jpg">
      <p>Hercules</p>
    </div>
  </div>

  <ul class="help">
    <li>
      <a href="#">
        <h1 class="ligaturesymbols">&#xe093;</h1>
        <p>Select</p>
      </a>
    </li>
    <li>
      <a href="#">
        <h1 class="return">&#x21b5;</h1>
        <p>Play</p>
      </a>
    </li>
    <li id="close-button">
      <a href="#">
        <h1>esc</h1>
        <p>Close</p>
      </a>
    </li>
  </ul>
</div>

<div id="dialogue">
  <div>
    <h1></h1>
    <p></p>
  </div>
</div>

<script src="jquery-2.1.1.min.js"></script>
<script>
$(document).ready(function() {
  function show_home() {
    $("#home").toggleClass("active");
    $("#tv-help").toggle();
    return false;
  }
  var hide_home = show_home;

  function dialogue(title, message) {
    $("#dialogue h1").text(title);
    $("#dialogue p").text(message);
    $("#dialogue").show();
  }

  var play_patch_timeout;
  function pause_or_play() {
    var tv = $("#tv")[0];
    if (tv.paused) {
      tv.play();
      show_play_patch();
      $("#pause-button p").text("Pause");
    }
    else {
      tv.pause();
      show_pause_patch();
      $("#pause-button p").text("Play");
    }
  }
  function show_play_patch() {
    $("#pause-patch").html("&#xe106;");
    $("#pause-patch").show();
    play_patch_timeout = setTimeout(
      function() { $("#pause-patch").fadeOut(500) },
      1000);
  }
  function show_pause_patch() {
    clearTimeout(play_patch_timeout);
    $("#pause-patch").html("&#xe09d;");
    $("#pause-patch").show();
  }

  // background must be outside of `.carousel div`, so that it is a sibling of
  // `.carousel-selection` so that z-index works (z-indexes are only relative
  // between children of the same parent).
  function create_carousel_backgrounds() {
    var backgrounds = $("<div class='carousel-backgrounds'></div>");
    var carousel = $("#home .carousel");
    backgrounds.css({
      position: "absolute",
      top: carousel.css("top"),
      left: carousel.css("left"),
    });
    $("#home .carousel div").each(function(n, div) {
      var background = $("<div></div>");
      var item = $(div);
      background.css({
        position: "absolute",
        padding: item.css("padding"),
        top: item.css("top"),
        left: item.css("left"),
        width: item.css("width"),
        height: item.css("height"),
      });
      backgrounds.append(background);
    });
    $("#home").append(backgrounds);
  }

  var selection = $("<div class='carousel-selection'></div>");
  move_selection_to(1);
  $("#home").append(selection);
  function move_selection_to(index) {
    var carousel = $("#home .carousel");
    var item = $($("#home .carousel div")[index - 1]);
    selection.css({
      position: "absolute",
      padding: item.css("padding"),
      top: item.position().top + carousel.position().top,
      left: item.position().left + carousel.position().left,
      width: item.css("width"),
      height: item.css("height"),
    });
    selection.carousel_index = index;
  }
  function move_selection(direction) {
    var num_items = $("#home .carousel div").length;
    switch(direction) {
      case "left":
        if (selection.carousel_index %4 != 1) {
          move_selection_to(selection.carousel_index - 1);
        }
        break;
      case "right":
        if (selection.carousel_index % 4 != 0 &&
            selection.carousel_index < num_items) {
          move_selection_to(selection.carousel_index + 1);
        }
        break;
      case "up":
        if (selection.carousel_index > 4) {
          move_selection_to(selection.carousel_index - 4);
        }
        break;
      case "down":
        if (selection.carousel_index + 4 <= num_items) {
          move_selection_to(selection.carousel_index + 4);
        }
        break;
    }
  }
  function select() {
    var item = $($("#home .carousel div")[selection.carousel_index - 1]);
    var movie_url = item.data("movie");
    if (movie_url) {
      $("#tv").attr("src", movie_url);
      $("#tv")[0].load();
      show_play_patch();
      hide_home();
    }
    else {
      dialogue(
        "Error", "This content is not available to stream in your region.");
    }
  }

  // Forget current selection when the user closes the menu.
  $("#home").on("transitionend", function(e) {
    if (e.target == $("#home")[0] && $("#home").position().left != 0) {
      move_selection_to(1);
    }
  });

  create_carousel_backgrounds();
  $("#home-button").click(show_home);
  $("#close-button").click(hide_home);
  $("#pause-button").click(pause_or_play);

  $(document).keydown(function(e) {
    if (e.ctrlKey || e.altKey || e.metaKey) {
      return true;
    }
    if ($("#dialogue").css("display") != "none") {
      switch (e.which) {
        case 13:  // enter
        case 27:  // escape
          $("#dialogue").fadeOut();
          break;
      }
      return false;
    }
    if ($("#home").hasClass("active")) {
      switch (e.which) {
        case 13: select(); break;  // enter
        case 27: hide_home(); break;  // escape
        case 37: move_selection("left"); break;
        case 38: move_selection("up"); break;
        case 39: move_selection("right"); break;
        case 40: move_selection("down"); break;
      }
    }
    else {  // tv
      switch (e.which) {
        case "H".charCodeAt(0): show_home(); break;
        case "P".charCodeAt(0): pause_or_play(); break;
      }
    }
    return false;
  });
});
</script>

</div>
</body>
</html>
